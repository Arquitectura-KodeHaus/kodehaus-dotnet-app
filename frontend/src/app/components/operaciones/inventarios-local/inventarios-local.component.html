<div class="inventarios-local-container">
  <!-- Header con informaci√≥n del local -->
  <div class="toolbar">
    <div>
      <button class="btn-secondary" (click)="volverAOperaciones()">
        ‚Üê Volver a Operaciones
      </button>
      <h1>üì¶ Inventarios - {{ local?.nombre }}</h1>
      <div class="small">{{ local?.numeroLocal }} | {{ local?.categoria }}</div>
    </div>
    <button class="btn" (click)="mostrarFormularioCrear()">
      <span>+</span> Nuevo Producto
    </button>
  </div>

  <!-- Estad√≠sticas del local -->
  <div class="cards">
    <div class="card">
      <div class="card-icon">üì¶</div>
      <h4>Total Productos</h4>
      <div class="value">{{ estadisticas.totalProductos }}</div>
    </div>
    
    <div class="card">
      <div class="card-icon">üí∞</div>
      <h4>Valor Total</h4>
      <div class="value">${{ estadisticas.valorTotal | number:'1.2-2' }}</div>
    </div>
    
    <div class="card">
      <div class="card-icon">‚ö†Ô∏è</div>
      <h4>Stock Bajo</h4>
      <div class="value">{{ estadisticas.stockBajo }}</div>
    </div>
    
    <div class="card">
      <div class="card-icon">üö´</div>
      <h4>Agotados</h4>
      <div class="value">{{ estadisticas.stockAgotado }}</div>
    </div>
  </div>

  <!-- Formulario Modal -->
  <div class="modal-overlay" *ngIf="mostrarFormulario" (click)="cancelarFormulario()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ modoEdicion ? 'Editar Inventario' : 'Nuevo Producto' }}</h2>
        <button class="btn-close" (click)="cancelarFormulario()">&times;</button>
      </div>
      
      <form (ngSubmit)="guardarInventario()">
        <div class="form-row">
          <label for="idProductoCatalogo">ID Producto Cat√°logo</label>
          <input 
            type="number" 
            id="idProductoCatalogo" 
            [(ngModel)]="nuevoInventario.idProductoCatalogo" 
            name="idProductoCatalogo"
            required
            placeholder="Ej: 1001"
            class="input"
          >
        </div>

        <div class="form-row">
          <label for="precioUnitario">Precio Unitario</label>
          <input 
            type="number" 
            id="precioUnitario" 
            [(ngModel)]="nuevoInventario.precioUnitario" 
            name="precioUnitario"
            step="0.01"
            required
            placeholder="Ej: 25.99"
            class="input"
          >
        </div>

        <div class="form-row">
          <label for="stock">Stock</label>
          <input 
            type="number" 
            id="stock" 
            [(ngModel)]="nuevoInventario.stock" 
            name="stock"
            required
            placeholder="Ej: 50"
            class="input"
          >
        </div>

        <div class="form-row">
          <button type="button" class="btn-secondary" (click)="cancelarFormulario()">
            Cancelar
          </button>
          <button type="submit" class="btn">
            {{ modoEdicion ? 'Actualizar' : 'Crear' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Tabla de inventarios -->
  <div class="chart">
    <h3>Productos en Inventario</h3>
    <div class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th>ID Producto</th>
            <th>Precio Unitario</th>
            <th>Stock</th>
            <th>Valor Total</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let inventario of inventarios">
            <td>{{ inventario.idProductoCatalogo }}</td>
            <td>${{ inventario.precioUnitario | number:'1.2-2' }}</td>
            <td>{{ inventario.stock }}</td>
            <td>${{ (inventario.precioUnitario * inventario.stock) | number:'1.2-2' }}</td>
            <td>
              <span class="status" [ngClass]="obtenerStockClass(inventario.stock)">
                {{ inventario.stock === 0 ? 'Agotado' : inventario.stock < 10 ? 'Stock Bajo' : 'Disponible' }}
              </span>
            </td>
            <td class="actions">
              <button (click)="mostrarFormularioEditar(inventario)" title="Editar">
                ‚úèÔ∏è
              </button>
              <button (click)="eliminarInventario(inventario.id)" title="Eliminar">
                üóëÔ∏è
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Estado vac√≠o -->
  <div class="empty-state" *ngIf="inventarios.length === 0">
    <div class="empty-icon">üì¶</div>
    <h3>No hay productos en inventario</h3>
    <p>Agrega productos para comenzar a gestionar el inventario de este local</p>
    <button class="btn" (click)="mostrarFormularioCrear()">
      <span>+</span> Agregar Primer Producto
    </button>
  </div>
</div>
